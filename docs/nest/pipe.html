<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.60">
    <script>
      (function() {
        const userMode = localStorage.getItem('vuepress-reco-color-scheme') || 'auto';
        const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;

        if (userMode === 'dark' || (userMode === 'auto' && systemDarkMode)) {
          document.documentElement.classList.toggle('dark', true);
        }
      })();
    </script>
    <link rel="shortcut icon" type="image/x-icon" href="/lan-blog/favicon.ico"><title>管道 | lan blog</title><meta name="description" content="Personal Learning Blog">
    <link rel="modulepreload" href="/lan-blog/assets/app-e57f8f10.js"><link rel="modulepreload" href="/lan-blog/assets/framework-e1bed10d.js"><link rel="modulepreload" href="/lan-blog/assets/pipe.html-755ade42.js"><link rel="modulepreload" href="/lan-blog/assets/pipe.html-2c131693.js"><link rel="prefetch" href="/lan-blog/assets/index.html-6d5e9dd3.js" as="script"><link rel="prefetch" href="/lan-blog/assets/index.html-3237a27f.js" as="script"><link rel="prefetch" href="/lan-blog/assets/controller.html-bb0ba4ca.js" as="script"><link rel="prefetch" href="/lan-blog/assets/customize-decotator.html-2ca5c3f3.js" as="script"><link rel="prefetch" href="/lan-blog/assets/decotator.html-b75f9cc1.js" as="script"><link rel="prefetch" href="/lan-blog/assets/guard.html-a991bee2.js" as="script"><link rel="prefetch" href="/lan-blog/assets/interceptor-filter.html-4ac6bf51.js" as="script"><link rel="prefetch" href="/lan-blog/assets/introduce.html-9040f34a.js" as="script"><link rel="prefetch" href="/lan-blog/assets/ioc-di.html-bec555de.js" as="script"><link rel="prefetch" href="/lan-blog/assets/middleware.html-d42dea94.js" as="script"><link rel="prefetch" href="/lan-blog/assets/module.html-0892d837.js" as="script"><link rel="prefetch" href="/lan-blog/assets/providers.html-ff9d382c.js" as="script"><link rel="prefetch" href="/lan-blog/assets/session.html-ac889578.js" as="script"><link rel="prefetch" href="/lan-blog/assets/upload-download.html-621ff212.js" as="script"><link rel="prefetch" href="/lan-blog/assets/base.html-fe65d884.js" as="script"><link rel="prefetch" href="/lan-blog/assets/communication.html-28f2568f.js" as="script"><link rel="prefetch" href="/lan-blog/assets/component.html-04fb6b1a.js" as="script"><link rel="prefetch" href="/lan-blog/assets/control-uncontrol.html-497fa0a0.js" as="script"><link rel="prefetch" href="/lan-blog/assets/dvaJs.html-96f217ac.js" as="script"><link rel="prefetch" href="/lan-blog/assets/hooks.html-9de38d2b.js" as="script"><link rel="prefetch" href="/lan-blog/assets/immutable.html-f0950994.js" as="script"><link rel="prefetch" href="/lan-blog/assets/jsx.html-204af034.js" as="script"><link rel="prefetch" href="/lan-blog/assets/life-cycle.html-d3f69179.js" as="script"><link rel="prefetch" href="/lan-blog/assets/mobx.html-d2c19d5b.js" as="script"><link rel="prefetch" href="/lan-blog/assets/react-saga.html-29c84a71.js" as="script"><link rel="prefetch" href="/lan-blog/assets/react-supplement.html-1ca4c2a3.js" as="script"><link rel="prefetch" href="/lan-blog/assets/redux.html-747bb324.js" as="script"><link rel="prefetch" href="/lan-blog/assets/routerV5.html-e9b3a873.js" as="script"><link rel="prefetch" href="/lan-blog/assets/routerV6.html-c76d9e2f.js" as="script"><link rel="prefetch" href="/lan-blog/assets/solt.html-2778754a.js" as="script"><link rel="prefetch" href="/lan-blog/assets/state-props.html-d77cbdd5.js" as="script"><link rel="prefetch" href="/lan-blog/assets/styled-components.html-bb06ac7d.js" as="script"><link rel="prefetch" href="/lan-blog/assets/summary.html-a0e432b7.js" as="script"><link rel="prefetch" href="/lan-blog/assets/404.html-60b35caa.js" as="script"><link rel="prefetch" href="/lan-blog/assets/index.html-40bced6f.js" as="script"><link rel="prefetch" href="/lan-blog/assets/index.html-3c78780e.js" as="script"><link rel="prefetch" href="/lan-blog/assets/controller.html-0e084890.js" as="script"><link rel="prefetch" href="/lan-blog/assets/customize-decotator.html-7ff41c67.js" as="script"><link rel="prefetch" href="/lan-blog/assets/decotator.html-deb24935.js" as="script"><link rel="prefetch" href="/lan-blog/assets/guard.html-8e89ef92.js" as="script"><link rel="prefetch" href="/lan-blog/assets/interceptor-filter.html-94f2f843.js" as="script"><link rel="prefetch" href="/lan-blog/assets/introduce.html-22a66ee3.js" as="script"><link rel="prefetch" href="/lan-blog/assets/ioc-di.html-85b74df3.js" as="script"><link rel="prefetch" href="/lan-blog/assets/middleware.html-dcabae94.js" as="script"><link rel="prefetch" href="/lan-blog/assets/module.html-a9a0acaf.js" as="script"><link rel="prefetch" href="/lan-blog/assets/providers.html-13b34385.js" as="script"><link rel="prefetch" href="/lan-blog/assets/session.html-f3eb5c0f.js" as="script"><link rel="prefetch" href="/lan-blog/assets/upload-download.html-38549674.js" as="script"><link rel="prefetch" href="/lan-blog/assets/base.html-1a67361b.js" as="script"><link rel="prefetch" href="/lan-blog/assets/communication.html-0e46f901.js" as="script"><link rel="prefetch" href="/lan-blog/assets/component.html-162c6c26.js" as="script"><link rel="prefetch" href="/lan-blog/assets/control-uncontrol.html-360eb0be.js" as="script"><link rel="prefetch" href="/lan-blog/assets/dvaJs.html-d3e6be3b.js" as="script"><link rel="prefetch" href="/lan-blog/assets/hooks.html-a19c15cf.js" as="script"><link rel="prefetch" href="/lan-blog/assets/immutable.html-a156ece1.js" as="script"><link rel="prefetch" href="/lan-blog/assets/jsx.html-b24da5cf.js" as="script"><link rel="prefetch" href="/lan-blog/assets/life-cycle.html-b33e83ec.js" as="script"><link rel="prefetch" href="/lan-blog/assets/mobx.html-2f1b026b.js" as="script"><link rel="prefetch" href="/lan-blog/assets/react-saga.html-e03dfccd.js" as="script"><link rel="prefetch" href="/lan-blog/assets/react-supplement.html-776d7b83.js" as="script"><link rel="prefetch" href="/lan-blog/assets/redux.html-b4c23f46.js" as="script"><link rel="prefetch" href="/lan-blog/assets/routerV5.html-2b84e9fc.js" as="script"><link rel="prefetch" href="/lan-blog/assets/routerV6.html-ba243ddb.js" as="script"><link rel="prefetch" href="/lan-blog/assets/solt.html-562e839b.js" as="script"><link rel="prefetch" href="/lan-blog/assets/state-props.html-efeeac57.js" as="script"><link rel="prefetch" href="/lan-blog/assets/styled-components.html-4bcce410.js" as="script"><link rel="prefetch" href="/lan-blog/assets/summary.html-62920876.js" as="script"><link rel="prefetch" href="/lan-blog/assets/404.html-7c90b0cc.js" as="script"><link rel="prefetch" href="/lan-blog/assets/reco-valine-a0c1af1f.js" as="script">
    <link rel="preload" href="/lan-blog/assets/style-24010328.css" as="style"><link rel="stylesheet" href="/lan-blog/assets/style-24010328.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><div class="common-wrapper show-series show-catalog"><div><header class="navbar-container"><!--[--><div class="site-brand nav-item"><img class="logo" src="/lan-blog/logo.png" alt="lan blog"><a href="/lan-blog/" class="site-name can-hide">lan blog</a></div><div class="nav-item navbar-links-wrapper" style=""><form class="search-box" role="search"><input type="search" autocomplete="off" spellcheck="false" value><!----></form><nav class="navbar-links"><!--[--><div class="navbar-links__item"><a href="/lan-blog/" class="link router-link-active" aria-label="Home"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Home<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="前端框架学习"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->前端框架学习<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="前端框架学习"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->前端框架学习<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/lan-blog/docs/react/base" class="link" aria-label="react"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->react<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/lan-blog/docs/nest/introduce" class="link" aria-label="nest"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->nest<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><a href="/lan-blog/docs/work/summary" class="link" aria-label="工作中总结"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->工作中总结<!--]--></span></span><!--[--><!--]--></a></div><!--]--></nav><span class="xicon-container btn-toggle-dark-mode btn--dark-mode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span><span class="xicon-container btn-toggle-menus"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><circle cx="16" cy="8" r="2" fill="currentColor"></circle><circle cx="16" cy="16" r="2" fill="currentColor"></circle><circle cx="16" cy="24" r="2" fill="currentColor"></circle></svg></span></div><!--]--></header><div class="mobile-menus-container"><nav class="navbar-links mobile"><!--[--><div class="navbar-links__item"><a href="/lan-blog/" class="link router-link-active" aria-label="Home"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Home<!--]--></span></span><!--[--><!--]--></a></div><div class="navbar-links__item"><div class="dropdown-link"><button class="dropdown-link__title" type="button" aria-label="前端框架学习"><span class="xicon-container left title"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->前端框架学习<!--]--></span></span><span class="arrow down"></span></button><button class="dropdown-link--mobile__title" type="button" aria-label="前端框架学习"><span class="title"><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->前端框架学习<!--]--></span></span></span><span class="right arrow"></span></button><ul style="display:none;" class="dropdown-link__container"><!--[--><li class="dropdown-link__item"><a href="/lan-blog/docs/react/base" class="link" aria-label="react"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->react<!--]--></span></span><!--[--><!--]--></a></li><li class="dropdown-link__item"><a href="/lan-blog/docs/nest/introduce" class="link" aria-label="nest"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->nest<!--]--></span></span><!--[--><!--]--></a></li><!--]--></ul></div></div><div class="navbar-links__item"><a href="/lan-blog/docs/work/summary" class="link" aria-label="工作中总结"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->工作中总结<!--]--></span></span><!--[--><!--]--></a></div><!--]--></nav><div class="appearance"><span>Appearance</span><span class="xicon-container btn-toggle-dark-mode"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M15 2h2v3h-2z" fill="currentColor"></path><path d="M27 15h3v2h-3z" fill="currentColor"></path><path d="M15 27h2v3h-2z" fill="currentColor"></path><path d="M2 15h3v2H2z" fill="currentColor"></path><path d="M5.45 6.884l1.414-1.415l2.121 2.122l-1.414 1.414z" fill="currentColor"></path><path d="M23 7.58l2.121-2.12l1.414 1.414l-2.121 2.121z" fill="currentColor"></path><path d="M23.002 24.416l1.415-1.414l2.12 2.122l-1.413 1.414z" fill="currentColor"></path><path d="M5.47 25.13L7.59 23L9 24.42l-2.12 2.12l-1.41-1.41z" fill="currentColor"></path><path d="M16 8a8 8 0 1 0 8 8a8 8 0 0 0-8-8zm0 14a6 6 0 0 1 0-12z" fill="currentColor"></path></svg></span></div></div><div class="series-mask"></div><aside class="series-container"><div class="site-brand"><img class="logo" src="/lan-blog/logo.png" alt="lan blog"><a href="/lan-blog/" class="site-name can-hide">lan blog</a></div><!--[--><!--[--><a href="/lan-blog/docs/nest/introduce.html" class="link series-item" aria-label="介绍nest.js"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->介绍nest.js<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/ioc-di.html" class="link series-item" aria-label="IOC控制反转 DI依赖注入"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->IOC控制反转 DI依赖注入<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/decotator.html" class="link series-item" aria-label="ts装饰器"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->ts装饰器<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/controller.html" class="link series-item" aria-label="控制器"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->控制器<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/session.html" class="link series-item" aria-label="Session"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Session<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/providers.html" class="link series-item" aria-label="提供者"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->提供者<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/module.html" class="link series-item" aria-label="模块"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->模块<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/middleware.html" class="link series-item" aria-label="中间件"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->中间件<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/upload-download.html" class="link series-item" aria-label="文件上传与下载"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->文件上传与下载<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/interceptor-filter.html" class="link series-item" aria-label="拦截器与异常过滤器"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->拦截器与异常过滤器<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a aria-current="page" href="/lan-blog/docs/nest/pipe.html" class="router-link-active router-link-exact-active link router-link-active series-item active" aria-label="管道"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->管道<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/guard.html" class="link series-item" aria-label="守卫"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->守卫<!--]--></span></span><!--[--><!--]--></a><!--]--><!--[--><a href="/lan-blog/docs/nest/customize-decotator.html" class="link series-item" aria-label="自定义装饰器"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->自定义装饰器<!--]--></span></span><!--[--><!--]--></a><!--]--><!--]--></aside><!--[--><main class="page-container"><h1 class="page-title">管道</h1><div class="page-info"><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M16 4a5 5 0 1 1-5 5a5 5 0 0 1 5-5m0-2a7 7 0 1 0 7 7a7 7 0 0 0-7-7z" fill="currentColor"></path><path d="M26 30h-2v-5a5 5 0 0 0-5-5h-6a5 5 0 0 0-5 5v5H6v-5a7 7 0 0 1 7-7h6a7 7 0 0 1 7 7z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->lan<!--]--></span></span><span class="xicon-container left"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:18px;height:18px;font-size:18px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->2023/05/30<!--]--></span></span><!----><!----><!----></div><div class="theme-reco-default-content"><div><h2 id="内置管道" tabindex="-1"><a class="header-anchor" href="#内置管道" aria-hidden="true">#</a> 内置管道</h2><p><code>Nest</code>自带九个开箱即用的管道</p><ul><li>ValidationPipe</li><li>ParseIntPipe</li><li>ParseFloatPipe</li><li>ParseBoolPipe</li><li>ParseArrayPipe</li><li>ParseUUIDPipe</li><li>ParseEnumPipe</li><li>DefaultValuePipe</li><li>ParseFilePipe</li></ul><p>为了使用管道，我们需要将一个管道类的实例绑定到合适的情境。在我们的 ParseIntPipe 示例中，我们希望将管道与特定的路由处理程序方法相关联，并确保它在该方法被调用之前运行。我们使用以下构造来实现，并其称为在方法参数级别绑定管道:</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>@<span class="token function">Get</span><span class="token punctuation">(</span><span class="token string">&#39;:id&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">async</span> <span class="token function">findOne</span><span class="token punctuation">(</span>@<span class="token function">Param</span><span class="token punctuation">(</span><span class="token string">&#39;id&#39;</span><span class="token punctuation">,</span> ParseIntPipe<span class="token punctuation">)</span> id<span class="token operator">:</span> number<span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>catsService<span class="token punctuation">.</span><span class="token function">findOne</span><span class="token punctuation">(</span>id<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="自定义管道" tabindex="-1"><a class="header-anchor" href="#自定义管道" aria-hidden="true">#</a> 自定义管道</h2><div class="custom-container tip"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 24 24"><g fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"></circle><path d="M12 8h.01"></path><path d="M11 12h1v4h1"></path></g></svg><p class="custom-container-title">TIP</p><p>PipeTransform&lt;T, R&gt; 是每个管道必须要实现的泛型接口。泛型 T 表明输入的 value 的类型，R 表明 transfrom() 方法的返回类型</p></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>@<span class="token function">Injectable</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">LoginPipe</span> <span class="token keyword">implements</span> <span class="token class-name">PipeTransform</span> <span class="token punctuation">{</span>
  <span class="token keyword">async</span> <span class="token function">transform</span><span class="token punctuation">(</span><span class="token parameter"><span class="token literal-property property">value</span><span class="token operator">:</span> any<span class="token punctuation">,</span> <span class="token literal-property property">metadata</span><span class="token operator">:</span> ArgumentMetadata</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span> metadata<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> dto <span class="token operator">=</span> <span class="token function">plainToInstance</span><span class="token punctuation">(</span>metadata<span class="token punctuation">.</span>metatype<span class="token punctuation">,</span> value<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> errors <span class="token operator">=</span> <span class="token keyword">await</span> <span class="token function">validate</span><span class="token punctuation">(</span>dto<span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>errors<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>errors<span class="token punctuation">.</span>length <span class="token operator">&gt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">HttpException</span><span class="token punctuation">(</span>errors<span class="token punctuation">,</span> HttpStatus<span class="token punctuation">.</span><span class="token constant">BAD_REQUEST</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

 @<span class="token function">Post</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token function">create</span><span class="token punctuation">(</span><span class="token parameter">@<span class="token function">Body</span><span class="token punctuation">(</span>LoginPipe<span class="token punctuation">)</span> createLoginDto<span class="token operator">:</span> CreateLoginDto</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>loginService<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>createLoginDto<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>Nest 与 class-validator 配合得很好。这个优秀的库允许您使用基于装饰器的验证。装饰器的功能非常强大，尤其是与 Nest 的 Pipe 功能相结合使用时，因为我们可以通过访问 metatype 信息做很多事情.</p><blockquote><p>npm i --save class-validator class-transformer</p></blockquote><h2 id="全局管道" tabindex="-1"><a class="header-anchor" href="#全局管道" aria-hidden="true">#</a> 全局管道</h2><p>由于 ValidationPipe 被创建为尽可能通用，所以我们将把它设置为一个全局作用域的管道，用于整个应用程序中的每个路由处理器。</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> app <span class="token operator">=</span> <span class="token keyword">await</span> NestFactory<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span>AppModule<span class="token punctuation">)</span>
  app<span class="token punctuation">.</span><span class="token function">useGlobalPipes</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">ValidationPipe</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">await</span> app<span class="token punctuation">.</span><span class="token function">listen</span><span class="token punctuation">(</span><span class="token number">3000</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
<span class="token function">bootstrap</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></div></div><footer class="page-meta"><div class="meta-item edit-link"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M2 26h28v2H2z" fill="currentColor"></path><path d="M25.4 9c.8-.8.8-2 0-2.8l-3.6-3.6c-.8-.8-2-.8-2.8 0l-15 15V24h6.4l15-15zm-5-5L24 7.6l-3 3L17.4 7l3-3zM6 22v-3.6l10-10l3.6 3.6l-10 10H6z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Edit this page<!--]--></span></span></div><div class="meta-item last-updated"><span class="xicon-container left meta-item-label"><!--[--><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 32 32" class="xicon-icon" style="width:20px;height:20px;font-size:20px;color:inherit;"><path d="M26 4h-4V2h-2v2h-8V2h-2v2H6c-1.1 0-2 .9-2 2v20c0 1.1.9 2 2 2h20c1.1 0 2-.9 2-2V6c0-1.1-.9-2-2-2zm0 22H6V12h20v14zm0-16H6V6h4v2h2V6h8v2h2V6h4v4z" fill="currentColor"></path></svg><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->Last Updated 2023-05-30 09:54:33<!--]--></span></span></div></footer><nav class="page-nav"><p class="hasPrev hasNext inner"><span class="page-nav-item prev"> ← 拦截器与异常过滤器</span><span class="page-nav-item next">守卫 → </span></p></nav><!----></main><!--]--><div class="page-catalog-container"><h5 class="tip">ON THIS PAGE</h5><ul><!--[--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/lan-blog/docs/nest/pipe.html#内置管道" class="router-link-active router-link-exact-active link page-catalog-item" aria-label="内置管道"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->内置管道<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/lan-blog/docs/nest/pipe.html#自定义管道" class="router-link-active router-link-exact-active link page-catalog-item" aria-label="自定义管道"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->自定义管道<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--[--><li class="page-catalog-menu-depth_2"><a aria-current="page" href="/lan-blog/docs/nest/pipe.html#全局管道" class="router-link-active router-link-exact-active link page-catalog-item" aria-label="全局管道"><!--[--><!--]--><span class="xicon-container left"><!--[--><!----><!--]--><span class="xicon-content" style="color:inherit;font-size:14px;"><!--[-->全局管道<!--]--></span></span><!--[--><!--]--></a></li><!--]--><!--]--></ul></div></div></div></div><!----><!----><!--]--></div>
    <script type="module" src="/lan-blog/assets/app-e57f8f10.js" defer></script>
  </body>
</html>
